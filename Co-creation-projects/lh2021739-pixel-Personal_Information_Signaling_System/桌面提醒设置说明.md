# Windows任务计划程序设置说明

## 功能说明

设置Windows任务计划程序，每天23:30自动弹出提醒窗口，提醒写日报。

## 📋 推荐配置方案

### 方案 1：使用项目虚拟环境（推荐）

如果项目有自己的虚拟环境（`.venv` 目录）：

**配置信息：**

- **程序或脚本**: 
  ```
  C:\Python\pythonprogram\Personal_Information_Signaling_System\.venv\Scripts\python.exe
  ```

- **添加参数（可选）**: 
  ```
  daily_reminder.py
  ```

- **起始于（可选）**: 
  ```
  C:\Python\pythonprogram\Personal_Information_Signaling_System
  ```

### 方案 2：使用系统 Python

如果使用系统安装的 Python（已添加到 PATH）：

**配置信息：**

- **程序或脚本**: 
  ```
  python.exe
  ```

- **添加参数（可选）**: 
  ```
  daily_reminder.py
  ```

- **起始于（可选）**: 
  ```
  C:\Python\pythonprogram\Personal_Information_Signaling_System
  ```

### 方案 3：直接运行脚本（如果配置了文件关联）

**配置信息：**

- **程序或脚本**: 
  ```
  C:\Python\pythonprogram\Personal_Information_Signaling_System\daily_reminder.py
  ```

- **起始于（可选）**: 
  ```
  C:\Python\pythonprogram\Personal_Information_Signaling_System
  ```

## 🔍 如何确认 Python 路径

### 方法 1：检查项目虚拟环境

```bash
cd C:\Python\pythonprogram\Personal_Information_Signaling_System
dir .venv\Scripts\python.exe
```

如果存在，使用：
```
C:\Python\pythonprogram\Personal_Information_Signaling_System\.venv\Scripts\python.exe
```

### 方法 2：检查系统 Python

在命令行输入：
```bash
where python
```

会显示 Python 的完整路径，例如：
```
C:\Python\python311\python.exe
```

### 方法 3：创建项目虚拟环境（如果还没有）

```bash
cd C:\Python\pythonprogram\Personal_Information_Signaling_System
python -m venv .venv
.venv\Scripts\activate
pip install -r requirements.txt
```

然后使用方案 1 的配置。

## 设置步骤

### 1. 打开任务计划程序

- 按 `Win + R` 打开运行对话框
- 输入 `taskschd.msc` 并回车
- 或者：开始菜单 → 搜索"任务计划程序"

### 2. 创建基本任务

1. 在右侧"操作"面板中，点击"创建基本任务"
2. 输入任务名称：`每日写日报提醒`
3. 输入描述：`每天23:30提醒写日报`
4. 点击"下一步"

### 3. 设置触发器

1. 选择"每天"
2. 点击"下一步"
3. 设置开始时间：`23:30:00`
4. 设置开始日期：今天或明天
5. 点击"下一步"

### 4. 设置操作

1. 选择"启动程序"
2. 点击"下一步"
3. 在"程序或脚本"中输入Python的完整路径：
   ```
   C:\Python\pythonprogram\Personal_Information_Signaling_System\.venv\Scripts\python.exe
   ```
   （如果项目有虚拟环境）
   
   或者使用系统 Python：
   ```
   python.exe
   ```
   （需要确保 Python 已添加到系统 PATH）

4. 在"添加参数"中输入：
   ```
   daily_reminder.py
   ```

5. 在"起始于"中输入脚本所在目录：
   ```
   C:\Python\pythonprogram\Personal_Information_Signaling_System
   ```
   （请根据你的实际路径修改）

6. 点击"下一步"

### 5. 完成设置

1. 勾选"当单击完成时，打开此任务属性的对话框"
2. 点击"完成"

### 6. 高级设置（可选）

在任务属性对话框中：

1. **常规**选项卡：
   - 勾选"不管用户是否登录都要运行"（可选）
   - 勾选"使用最高权限运行"（可选）

2. **条件**选项卡：
   - 取消勾选"只有在计算机使用交流电源时才启动此任务"（如果使用笔记本）
   - 勾选"唤醒计算机运行此任务"（可选）

3. **设置**选项卡：
   - 勾选"允许按需运行任务"
   - 勾选"如果请求的任务正在运行，则停止现有实例"

4. 点击"确定"保存

## 测试任务

### 方法1：立即运行测试

1. 在任务计划程序中找到创建的任务
2. 右键点击 → "运行"
3. 检查是否弹出提醒窗口

### 方法2：修改时间测试

1. 右键点击任务 → "属性"
2. 在"触发器"选项卡中，编辑触发器
3. 将时间改为当前时间+1分钟
4. 等待1分钟，观察是否弹出提醒窗口
5. 测试完成后，将时间改回23:30

## 常见问题

### 1. 任务不运行

- 检查Python路径是否正确
- 检查脚本路径是否正确
- 检查"起始于"目录是否正确
- 查看任务历史记录中的错误信息

### 2. 窗口不显示

- 检查是否安装了Pillow：`pip install Pillow`
- 检查图片文件是否存在：`assets/person.png`
- 检查是否有错误提示

### 3. 点击后不启动写日报

- 检查 `write_report.py` 是否存在
- 检查Python环境是否正确

## 开机自启动（可选）

如果需要开机自启动提醒服务（后台运行）：

1. 创建启动脚本 `start_reminder_service.bat`：
   ```batch
   @echo off
   cd /d C:\Python\pythonprogram\Personal_Information_Signaling_System
   C:\Python\pythonprogram\Personal_Information_Signaling_System\.venv\Scripts\python.exe daily_reminder_service.py
   ```

2. 将脚本添加到启动文件夹：
   - 按 `Win + R`，输入 `shell:startup`
   - 将 `start_reminder_service.bat` 的快捷方式放入此文件夹

## 注意事项

1. **Python路径**：确保使用虚拟环境中的Python，或使用完整路径
2. **工作目录**：确保"起始于"目录设置正确
3. **权限**：可能需要管理员权限运行任务计划程序
4. **图片文件**：确保 `assets/person.png` 或 `assets/person.jpg` 存在

## 卸载

如果需要删除任务：

1. 打开任务计划程序
2. 找到"每日写日报提醒"任务
3. 右键点击 → "删除"

---

## 📝 更新现有任务（如果项目路径已更改）

如果你之前已经设置了桌面提醒任务，但项目路径已更改，需要更新任务配置：

### 需要更新的信息

#### 原配置信息（旧路径）

如果之前已经设置了桌面提醒任务，任务中可能包含以下路径：

- **程序或脚本**: `C:\Python\pythonprogram\datawhale_Agent\PersonalizationMCP-main\daily_reminder.py`
- **起始于**: `C:\Python\pythonprogram\datawhale_Agent\PersonalizationMCP-main`
- **Python 解释器路径**: 可能是虚拟环境路径，如 `C:\Python\pythonprogram\datawhale_Agent\.venv\Scripts\python.exe`

#### 新配置信息（更新后）

- **程序或脚本**: `C:\Python\pythonprogram\Personal_Information_Signaling_System\daily_reminder.py`
- **起始于**: `C:\Python\pythonprogram\Personal_Information_Signaling_System`
- **Python 解释器路径**: 
  - 如果使用项目虚拟环境: `C:\Python\pythonprogram\Personal_Information_Signaling_System\.venv\Scripts\python.exe`
  - 如果使用系统 Python: `python.exe`（如果已添加到系统 PATH）

### 详细更新步骤

#### 步骤 1：打开任务计划程序

1. 按 `Win + R` 打开运行对话框
2. 输入 `taskschd.msc` 并按回车
3. 或者：开始菜单 → 搜索"任务计划程序" → 打开

#### 步骤 2：找到你的任务

1. 在左侧"任务计划程序库"中查找你的任务
2. 任务名称可能是：
   - `每日写日报提醒`
   - `Daily Report Reminder`
   - `写日报提醒`
   - 或其他你自定义的名称

#### 步骤 3：编辑任务属性

1. **右键点击任务** → 选择"属性"（或双击任务）
2. 在弹出的属性窗口中，切换到 **"操作"** 标签页

#### 步骤 4：更新"操作"配置

在"操作"标签页中，更新以下字段：

1. **程序或脚本**:
   ```
   旧值: C:\Python\pythonprogram\datawhale_Agent\PersonalizationMCP-main\daily_reminder.py
   新值: C:\Python\pythonprogram\Personal_Information_Signaling_System\daily_reminder.py
   ```
   
   或者，如果使用 Python 解释器直接运行：
   ```
   旧值: C:\Python\pythonprogram\datawhale_Agent\.venv\Scripts\python.exe
   新值: C:\Python\pythonprogram\Personal_Information_Signaling_System\.venv\Scripts\python.exe
   ```
   （如果项目有虚拟环境）

2. **添加参数（可选）**:
   ```
   如果程序或脚本是 Python 解释器，这里应该填写:
   daily_reminder.py
   ```

3. **起始于**:
   ```
   旧值: C:\Python\pythonprogram\datawhale_Agent\PersonalizationMCP-main
   新值: C:\Python\pythonprogram\Personal_Information_Signaling_System
   ```

#### 步骤 5：确认并保存

1. 点击"确定"保存更改
2. 系统可能会要求输入管理员密码（如果任务需要管理员权限）

#### 步骤 6：测试任务

1. 右键点击任务 → 选择"运行"
2. 检查是否能正常弹出提醒窗口
3. 如果失败，检查"历史记录"标签页查看错误信息

### 通过命令行更新（高级）

如果你熟悉命令行，可以使用以下 PowerShell 命令：

```powershell
# 1. 查看现有任务
Get-ScheduledTask | Where-Object {$_.TaskName -like "*日报*" -or $_.TaskName -like "*reminder*"}

# 2. 获取任务的操作配置
$task = Get-ScheduledTask -TaskName "你的任务名称"
$task.Actions

# 3. 更新任务操作（需要管理员权限）
$action = New-ScheduledTaskAction -Execute "C:\Python\pythonprogram\Personal_Information_Signaling_System\daily_reminder.py" -WorkingDirectory "C:\Python\pythonprogram\Personal_Information_Signaling_System"
Set-ScheduledTask -TaskName "你的任务名称" -Action $action
```

---

## ✅ 配置检查清单

设置或更新任务计划程序后，请确认：

- [ ] **程序或脚本**路径正确且文件存在
- [ ] **起始于**路径正确且目录存在
- [ ] **添加参数**正确（如果使用 Python 解释器运行脚本）
- [ ] **触发器**时间正确（通常是每天 23:30）
- [ ] **测试运行**成功（右键任务 → 运行）

---

## 🎯 快速复制粘贴

### 方案 1（项目虚拟环境）

```
程序或脚本: C:\Python\pythonprogram\Personal_Information_Signaling_System\.venv\Scripts\python.exe
添加参数: daily_reminder.py
起始于: C:\Python\pythonprogram\Personal_Information_Signaling_System
```

### 方案 2（系统 Python）

```
程序或脚本: python.exe
添加参数: daily_reminder.py
起始于: C:\Python\pythonprogram\Personal_Information_Signaling_System
```

